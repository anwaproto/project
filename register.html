<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../css/bootstrap.css">
    <script src="../js/jquery.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/popper.min.js"></script>
    <link rel="stylesheet" href="../css/register.css">
</head>
<body>
    <header>
        <div class=" header1-size">
            <div class="float-left">
                <div class="header-logo border-bottom">
                    <div class="header-logo1">
                        <div>
                          <a href="index.html">
														<img class="mr-2" src="../img/plum_blossom.png" alt=""/>
														<img src="../img/logo_new.png" alt="" class="mr-5"/>
													</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="clearfix"></div>
        </div>    
        </div>
    </header>
    <div class="login_bg">
        <div class="loginsize">
            <h2>注册</h2>
            <input class="d-block mb-2" autofocus type="text" id="uname" placeholder="请输入用户名"/>
            <div style="height:30px;color:red;"></div>
            <input class="d-block" type="password" id="upwd" placeholder="请输入密码"/>
            <div style="height:30px;color:red;"></div>
            <input class="d-block" type="password" id="upwd2" placeholder="请确认密码"/>
            <div style="height:30px;color:red;"></div>
            <input class="d-block" type="text" id="email" placeholder="请输入邮箱"/>
            <div style="height:30px;color:red;"></div>
            <input class="d-block" type="text" id="phone" placeholder="手机号"/>
            <div style="height:30px;color:red;"></div>
            <a href="login.html" class=" login_a mt-2">已有账号,去登录</a>
            <div style="height:30px;color:red;" id="register_info"></div>
            <button class="btn btn-info w-100 pt-2 mt-3 float-right" id="reg_btn">注册</button>
        </div>
        <script>
                var reginfo=$('#register_info')
                var reg=$("#reg_btn")
                var uname=$("#uname")
                var upwd=$("#upwd")
                var upwd2=$("#upwd2")
                var phone=$("#phone")
                var email=$("#email")
                var reg1=/^[a-z0-9]{6,10}$/i
                var reg2=/^[a-z0-9]{3,8}$/i
                var reg3=/^[a-z0-9]{1,}@[a-z0-9]{1,}\.[a-z]{2,3}$/i
                var reg4=/^1[3-8][3-9][0-9]{8,8}$/i
                phone.blur(function(){
                    if(reg4.test(phone.val())){
                        phone.next().html("")
                    }else{
                        phone.next().html("手机号格式不对")
                    }
                })
                email.blur(function(){
                    if(reg3.test(email.val())){
                        email.next().html("")
                    }else{
                        email.next().html("邮箱格式不正确")
                    }
                })
                upwd.blur(function(){
                    if(reg2.test(upwd.val())){
                        upwd.next().html("")
                    }else{
                        upwd.next().html("用户名应在6-10位之间,不能包含特殊符号")
                    }
                })
                upwd2.blur(function(){
                    if(upwd.val()==upwd2.val()){
                        upwd2.next().html("")
                    }else{
                        upwd2.next().html("两次输入密码不一致")
                    }
                })
                uname.blur(function(){
                    if(reg1.test(uname.val())){
                        uname.next().html("")
                    }else{
                        uname.next().html("用户名应在6-10位之间,不能包含特殊符号")
                    }
                })
                reg.click(function(){
                    if(reg1.test(uname.val())&&reg2.test(upwd.val())&&upwd.val()==upwd2.val()&&reg3.test(email.val())&&reg4.test(phone.val())){
                        var url="http://127.0.0.1:3000/register?uname="+uname.val()+'&&upwd='+upwd.val()+'&&email='+email.val()+'&&phone='+phone.val()
                        $.ajax({url,type:'get',dataType:'json'}).then(result=>{
                            console.log(result)
                            if(result.affectedRows>0){
                                reginfo.html("注册成功")
                                location='index.html'
                            }else{
                                reginfo.html("用户名被占用")
                            }
                        })                   
                    }
                })
            </script>
    </div>
    <footer>
        <div class=" footersize">
            <div class="">
                <a href="#" class=" footerkf text-dark footersm">
                    <div class="footerkfimg"></div>
                    在线客服
                </a>
                <a href="#" class=" footerkf text-dark footersm">
                    <div class="footerwximg"></div>
                    微信公众号
                </a>
            </div>
            <table></table>
            <div class="mcenter mt-3">
                <p class="footerdhimg align-bottom"></p>
                <span class="footersm">
                    客服电话：4001-578-578 服务时间（08:30-22:30）
                </span>
            </div>
            <div class="mt-3">
                <ul class="breadcrumb m-0 footersm justify-content-center">
                    <li class="breadcrumb-item">
                        <a href="#">诺心公告</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="#">关于诺心</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="#">联系我们</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="#">客服服务</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="#">食品经营许可证</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="#">生产许可证</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="#">预付卡协议</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="#">预付卡协议</a>
                    </li>
                    <li class="breadcrumb-item">
                        <a href="#" class="footershgs align-bottom"></a>
                        <a href="#">上海工商</a>
                    </li>
                </ul>
            </div>
            <p class="small  mt-3">诺心食品（上海）有限公司   上海徐汇区田林路140号28号楼503室  客服邮箱：services@lecake.com  公司电话：4001-578-578</p>
            <p class="small mb-0 mt-3">copyright©2010-2019 诺心lecake.com版权所有 沪ICP备10211730号</p>
        </div>
    </footer>
</body>
</html>